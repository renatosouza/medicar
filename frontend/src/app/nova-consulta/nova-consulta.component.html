<app-header></app-header>
<div class="nova-consulta">
    <div class="titulo-nova">Nova Consulta</div>
    
    <div class="error" *ngIf="form.hasError('Indisponivel')">
        <p>Horário já ocupado!</p>
    </div>
    
    <form class="cadastra-consulta" [formGroup]="form" (ngSubmit)="criaConsulta()">
        <div class="inputs">
            <select 
                class="item" 
                [ngClass]="{visited: form.controls['especialidade'].valid}"
                (change)="onChangeEspecialidade($event.target.value)"
                id="especialidade" 
                formControlName="especialidade"
            >
                <option [value]="null" disabled>Especialidade</option>
                <option 
                    *ngFor="let especialidade of especialidades" 
                    [value]="especialidade.id"
                >
                    {{ especialidade.nome }}
                </option>
            </select>

            <select 
                class="item"
                [ngClass]="{visited: form.controls['medico'].valid}"
                (change)="onChangeMedico($event.target.value)"
                id="medico" 
                formControlName="medico"
            >
                <option [value]="null" disabled>Médico</option>
                <option 
                    *ngFor="let medico of medicos" 
                    [value]="medico.id"
                >
                    {{ medico.nome }}
                </option>
            </select>

            <select 
                class="item"
                [ngClass]="{visited: form.controls['data'].valid}"
                (change)="onChangeAgenda($event.target.value)"
                id="data" 
                formControlName="data"
            >
                <option [value]="null" disabled>Data</option>
                <option 
                    *ngFor="let agenda of agendas" 
                    [value]="agenda.id"
                >
                    {{ agenda.dia.split('-').reverse().join('/') }}
                </option>
            </select>

            <select 
                class="item"
                [ngClass]="{visited: form.controls['hora'].valid}"
                id="hora"
                formControlName="hora"
            >
                <option [value]="null" disabled>Hora</option>
                <option 
                    *ngFor="let horario of horarios" 
                    [value]="horario"
                >
                    {{ horario }}
                </option>
            </select>
        </div>

        
        <div class="botoes">
            <a class="botao cancelar" [routerLink]="['/home']">Cancelar</a>
            <input class="botao confirmar" type="submit" value="Confirmar" [disabled]="!form.valid">
        </div>
    </form>
</div>